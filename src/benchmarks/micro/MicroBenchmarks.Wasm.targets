<Project>
  <PropertyGroup>
    <WasmBuildOnlyAfterPublish Condition="'$(RunAOTCompilation)' == 'true'">false</WasmBuildOnlyAfterPublish>
  </PropertyGroup>

  <Target Name="ExtraPrepareForWasmBuild" AfterTargets="PrepareForWasmBuild">
    <ItemGroup>
      <_LibrariesFile Include="$(TargetDir)publish\libraries\**\*" />
      <WasmFilesToIncludeInFileSystem Include="@(_LibrariesFile)" TargetPath="libraries\%(RecursiveDir)%(FileName)%(Extension)" />
    </ItemGroup>
  </Target>

  <Target Name="Validate" BeforeTargets="Build">
    <Error Text="Cannot find WasmMainJSPath: $(WasmMainJSPath)" Condition="'$(WasmMainJSPath)' == '' or !Exists('$(WasmMainJSPath)')" />
  </Target>
</Project>

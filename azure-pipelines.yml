resources:
  containers:
    - container: ubuntu_x64_build_container
      image: microsoft/dotnet-buildtools-prereqs:ubuntu-16.04-c103199-20180628134544

trigger:
- master

pr:
- master

jobs:

# Windows x64 micro benchmarks
- template: /eng/performance/benchmark_jobs.yml
  parameters:
    os: Windows
    kind: micro
    architecture: x64
    pool: Hosted VS2017
    # for public jobs we want to make sure that the PRs don't break any of the supported frameworks
    - ${{ if eq(variables['System.TeamProject'], 'public') }}:
      queue: Windows.Amd64.ClientRS4.DevEx.15.8.Perf
      frameworks:
        - netcoreapp3.0
        - netcoreapp2.2
        - netcoreapp2.1
        - netcoreapp2.0
        - net461
    # for private jobs we want to benchmark .NET Core 3.0 only, using a dedicated private Helix queue (perfsnakes)
    - ${{ if and(ne(variables['System.TeamProject'], 'public'), notin(variables['Build.Reason'], 'PullRequest')) }}:
      queue: Windows.10.Amd64.ClientRS1.Perf
      frameworks:
        - netcoreapp3.0